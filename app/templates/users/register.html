{% extends "layout.html" %}
{% block body %}

{% macro render_field(field, placeholder=None) %}
{% if field.errors %}
<div>
{% elif field.flags.error %}
<div>
{% else %}
<div>
{% endif %}
		{% set css_class = 'form-control ' + kwargs.pop('class', '') %}
		{{ field(class=css_class, placeholder=placeholder, **kwargs) }}
</div>
{% endmacro %}

<div>
	<div>
		<h2>Dołącz do Przygody</h2></br>

		{% with errors = get_flashed_messages(category_filter=["error"]) %}
		{% if errors %}
		<div>
		{% for error in errors %}
		{{ error }}<br>
		{% endfor %}
		</div>
		{% endif %}
		{% endwith %}

<!-- 		{% if form.errors %}
		<div>
		{% for field, error in form.errors.items() %}
		{% for e in error %}
		{{ e }}<br>
		{% endfor %}
		{% endfor %}
		</div>
		{% endif %} -->

		<form method="POST" action="." accept-charset="UTF-8" role="form">
			{{ form.csrf_token }}
			<div class="control-group">
				<div class="controls">
					{{ render_field(form.username, placeholder="Nazwa użytkownika", autofocus="") }}
				</div>
				<p class="col-sm-5 help-block">{{ form.username.errors[0] }}</p>
			</div>

			<div class="control-group">
				<div class="controls">
					{{ render_field(form.email, placeholder="Email") }}
				</div>
				<label for="firstname" class="error">{{ form.email.errors[0] }}</label>
			</div>


			<div class="control-group">
				<div class="controls">
					{{ render_field(form.password, placeholder="Hasło") }}
				</div>
				<p class="col-sm-5 help-block">{{ form.password.errors[0] }}</p>
			</div>

			<div class="control-group">
				<div class="controls">
					{{ render_field(form.confirm, placeholder="Powtórz hasło") }}
				</div>
				<p class="col-sm-5 help-block">{{ form.confirm.errors[0] }}</p>
			</div>

			<div class="control-group">
				<div class="controls">
					{{ render_field(form.accept_tos) }}
				</div>
			</div>

			<div class="control-group">
				<div class="controls">
					<button type="submit" class="btn btn-success">Zarejestruj się</button>
				</div>
			</div>
		</form>
	</div>
</div>

{% endblock %}
