{% extends "layout.html" %}
{% block body %}

{% macro render_field(field, placeholder=None) %}
	{% if field.errors %}
	<div>
	{% elif field.flags.error %}
	<div>
	{% else %}
	<div>
	{% endif %}

	{% set css_class = 'form-control ' + kwargs.pop('class', '') %}
	{{ field(class=css_class, placeholder=placeholder, **kwargs) }}
	</div>
{% endmacro %}

<div>
	<div>
		<h2>Stwórz przygodę</h2><br>

		{% with errors = get_flashed_messages(category_filter=["error"]) %}
		{% if errors %}
		<div>
		{% for error in errors %}
		{{ error }}<br>
		{% endfor %}
		</div>
		{% endif %}
		{% endwith %}

<!-- 		{% if form.errors %}
		<div>
		{% for field, error in form.errors.items() %}
		{% for e in error %}
		{{ e }}<br>
		{% endfor %}
		{% endfor %}
		</div>
		{% endif %} -->

		<form method="post" action="." accept-charset="UTF-8" role="form">
			{{ form.csrf_token }}
			<div class="control-group">
				<div class="controls">
					{{ render_field(form.date, placeholder="Data przygody", autofocus="") }}
				</div>
				<div class="control-group error">
					<small class="control-group error help-block">{{ form.date.errors[0] }}</small>
				</div>
			</div>

			<div class="control-group">
				<div class="controls">
					{{ render_field(form.info, placeholder="Informacje o przygodzie") }}
				</div>
				<div class="control-group error">
					<small class="control-group error help-block">{{ form.info.errors[0] }}</small>
				</div>
			</div>

			<div class="control-group">
				<div class="controls">
					<button type="submit" class="btn btn-success">Stwórz nową przygodę</button>
				</div>
			</div>
		</form>
	</div>
</div>
{% endblock %}
